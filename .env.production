# TeamBrain AI - Production Environment
# Self-hosted Supabase + Full Docker Stack
#
# Usage:
#   1. Copy this file to your server
#   2. Fill in all required values
#   3. Generate secrets: openssl rand -base64 32
#   4. Run: docker compose -f docker-compose.prod.yml up -d

# ============================================
# PLATFORM CREDENTIALS (Shared by all tenants)
# ============================================

# Google Gemini AI - Required for RAG
# Get from: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=

# Stripe Billing - Platform subscription management
# Get from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...
STRIPE_STARTER_PRICE_ID=price_...
STRIPE_PRO_PRICE_ID=price_...
STRIPE_BUSINESS_PRICE_ID=price_...

# ============================================
# SELF-HOSTED SUPABASE (All tenants use this)
# ============================================

# Generate with: openssl rand -base64 32
POSTGRES_PASSWORD=
JWT_SECRET=
SECRET_KEY_BASE=

# These are auto-generated from JWT_SECRET
# Run: scripts/generate-supabase-keys.sh to generate
SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# Internal Supabase URL (used by services in Docker network)
# External URL is constructed from DOMAIN below
SUPABASE_URL=http://kong:8000

# ============================================
# DOMAIN & SSL CONFIGURATION
# ============================================

# Your domain (required for SSL)
DOMAIN=cluebase.ai

# Email for Let's Encrypt SSL certificates
ACME_EMAIL=admin@cluebase.ai

# Public URLs (auto-constructed from DOMAIN)
API_URL=https://api.cluebase.ai
APP_URL=https://cluebase.ai

# ============================================
# TRAEFIK REVERSE PROXY
# ============================================

# Dashboard auth - Generate with:
# htpasswd -nb admin YourSecurePassword
# Double-escape $ signs for Docker: $$ instead of $
TRAEFIK_AUTH=admin:$$apr1$$xxxxxx

# Kong API Gateway port (internal, mapped to Supabase APIs)
KONG_HTTP_PORT=8000

# ============================================
# EMAIL (SMTP for Auth/Invites)
# ============================================

# Recommended: Resend (resend.com)
SMTP_HOST=smtp.resend.com
SMTP_PORT=465
SMTP_USER=resend
SMTP_PASS=re_your_api_key
SMTP_ADMIN_EMAIL=admin@cluebase.ai
SMTP_SENDER_NAME=Cluebase AI

# Set to true to skip email verification (not recommended for production)
MAILER_AUTOCONFIRM=false

# ============================================
# APPLICATION SETTINGS
# ============================================

NODE_ENV=production
LOG_LEVEL=info

# Background job schedules
# Cron expression for website scraping (default: 3am Sunday)
SCRAPE_SCHEDULE=0 3 * * 0

# Drive sync interval in milliseconds (default: 5 minutes)
DRIVE_POLL_INTERVAL_MS=300000

# ============================================
# GOOGLE OAUTH (Optional - Drive sync)
# ============================================
# These are optional - users configure per-workspace
# Only needed if you want platform-wide Drive access

# GOOGLE_CLIENT_ID=
# GOOGLE_CLIENT_SECRET=
# GOOGLE_REDIRECT_URI=https://api.teambrain.app/auth/google/callback

# ============================================
# SUPABASE STUDIO (Optional - Admin UI)
# ============================================

STUDIO_DEFAULT_ORGANIZATION=TeamBrain
STUDIO_DEFAULT_PROJECT=TeamBrain AI

# ============================================
# PER-WORKSPACE CREDENTIALS (NOT HERE!)
# ============================================

# The following are configured BY USERS in the dashboard:
# - Slack Bot Token (xoxb-...)
# - Slack App Token (xapp-...)
# - Slack Signing Secret
# - Google Drive Folder ID
# - Website URL to scrape
#
# These are stored in the database per-workspace/per-bot
# and are NOT platform-level environment variables.

# ============================================
# SECURITY NOTES
# ============================================

# 1. Generate strong, unique passwords for:
#    - POSTGRES_PASSWORD (32+ chars)
#    - JWT_SECRET (32+ chars)
#    - SECRET_KEY_BASE (64+ chars)
#
# 2. Never commit this file to version control
#
# 3. Rotate STRIPE_WEBHOOK_SECRET if compromised
#
# 4. Use environment-specific API keys (test vs live)
#
# 5. Enable Cloudflare WAF for additional protection
